# smart-glaze-support-bot

Чат-виджет для сайта + Telegram:

- **Карточки заявок** → тема **REQUESTS** (inline кнопки: “Перейти в ветку”, “Закрыть заявку”)
- **Системные логи** (“создано/закрыто/вышел”) → тема **LOGS**
- Диалог с клиентом → **отдельная ветка** `Session #<sid>`
- Клиентский виджет (Socket.IO) поддерживает отправку по Enter и блокируется, когда админ закрывает сессию

## 1) Подготовка чата в Telegram

1. Создай супергруппу или преврати группу в супергруппу.
2. **Включи Topics (Темы)** в настройках группы.
3. Добавь бота в группу и выдай права **Manage Topics** и **Delete/Pin messages** (по желанию).
4. Создай две темы:
   - `REQUESTS` (для карточек заявок)
   - `logs` (для служебных сообщений)
5. Узнай `ADMIN_GROUP_ID` (команда `/chatid` от бота в группе).
6. Узнай `REQUESTS_THREAD_ID` и `LOGS_THREAD_ID`:
   - Напиши что-нибудь в соответствующей теме — в логах сервера будет `message_thread_id`
   - Либо добавь временный логгер и посмотри `ctx.message.message_thread_id`

## 2) Переменные окружения

Смотри `.env.example`. На проде **не заливай** `.env` в репо — заполняй переменные в Railway → Variables.

## 3) Локальный запуск

```bash
npm install
cp .env.example .env   # и заполни .env
npm start
```
